# noVNC 文字貼上工具

一個 Chrome 瀏覽器插件，專門用於在 noVNC (Web-based VNC client) 環境下模擬緩慢的文字輸入。

## 功能特點

- 🎯 **自動檢測 noVNC 環境**：智能檢測當前頁面是否為 noVNC 環境
- 🎈 **懸浮小球介面**：在 noVNC 環境中顯示懸浮小球，無需點擊瀏覽器擴展圖示
- ⌨️ **模擬緩慢輸入**：避免因輸入過快導致的字符丟失問題
- 🛠️ **可調整延遲**：用戶可自定義每個字符間的輸入延遲時間
- 📝 **保存設定**：自動保存用戶的文字內容和延遲設定
- 🎮 **即時控制**：支援隨時停止貼上操作
- 📊 **進度顯示**：實時顯示貼上進度

## 安裝方式

1. **開發者模式安裝**：
   - 打開 Chrome 瀏覽器
   - 進入 `chrome://extensions/`
   - 開啟右上角的「開發人員模式」
   - 點擊「載入未封裝項目」
   - 選擇此專案資料夾

2. **打包安裝**（可選）：
   - 在擴充功能頁面點擊「封裝擴充功能」
   - 選擇此專案資料夾
   - 產生 `.crx` 檔案進行分發

## 使用方法

### 方法一：使用懸浮小球（推薦用於 noVNC 環境）

1. **開啟 noVNC 網頁**：瀏覽到任何使用 noVNC 的網頁
2. **點擊懸浮小球**：在頁面右上角會出現綠色的懸浮小球，點擊它
3. **輸入文字**：在彈出的面板中輸入要貼上的內容
4. **調整延遲**：根據需要調整輸入延遲時間（預設 50 毫秒）
5. **開始貼上**：點擊「開始貼上」按鈕
6. **監控進度**：觀察狀態顯示和進度更新

### 方法二：使用瀏覽器擴展圖示

1. **開啟 noVNC 網頁**：瀏覽到任何使用 noVNC 的網頁
2. **點擊插件圖示**：在瀏覽器工具列點擊插件圖示
3. **輸入文字**：在文字區域輸入要貼上的內容
4. **調整延遲**：根據需要調整輸入延遲時間（預設 50 毫秒）
5. **開始貼上**：點擊「開始貼上」按鈕
6. **監控進度**：觀察狀態顯示和進度更新

## 技術特點

### 智能檢測機制

- 檢測 noVNC canvas 元素
- 檢測相關 DOM 結構
- 檢測全域變數和 URL 特徵
- 支援多種 noVNC 變體

### 模擬輸入策略

- 使用真實的 KeyboardEvent
- 支援特殊鍵（Enter、Tab 等）
- 適應不同的輸入欄位類型
- 兼容各種 VNC 實現

### 用戶體驗優化

- 直觀的視覺介面
- 實時狀態回饋
- 設定自動保存
- 錯誤處理機制

## 檔案結構

```text
PasteTool/
├── manifest.json          # 擴充功能清單檔
├── popup.html             # 彈出視窗 HTML
├── popup.js               # 彈出視窗邏輯
├── content.js             # 內容腳本（核心功能）
├── background.js          # 背景腳本
├── styles.css             # 樣式檔案
└── README.md              # 說明檔案
```

## 相容性

- Chrome 88+ （Manifest V3）
- 支援所有主流 noVNC 實現
- 相容 HTTP 和 HTTPS 網頁

## 注意事項

- 某些 VNC 伺服器可能對輸入速度敏感，建議適當調整延遲時間
- 在複雜的網頁環境中，建議使用較高的延遲值以確保穩定性
- 如果檢測不到 noVNC 環境，插件仍可正常工作（可能是誤判）

## 故障排除

1. **檢測不到 noVNC**：
   - 檢查頁面是否完全載入
   - 嘗試重新整理頁面
   - 確認 noVNC canvas 是否可見

2. **字符輸入不完整**：
   - 增加輸入延遲時間
   - 確認 VNC 連線穩定
   - 檢查目標應用程式是否有焦點

3. **無法貼上**：
   - 確認已允許插件權限
   - 檢查是否有其他插件衝突
   - 嘗試重新載入插件

## 開發者

此插件使用現代 Web API 開發：

- Manifest V3
- Chrome Extension API
- DOM Events API
- Storage API

如需客製化或擴展功能，請參考原始碼中的詳細註釋。
